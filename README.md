# ダンジョンゲーム仕様書

## 仕様の決定方法

- 本仕様書の内容は、今後の議論や実装において基準となる「確定仕様」として扱う。
- 仕様を詳細化・確定する際は、質問形式で項目ごとの確認を行い、オーナー（kayabuking）がy（はい）／n（いいえ）で回答することで仕様を決定する。
- y/n回答は決定事項として記録し、仕様書に反映する。
- 追加質問や補足が必要な場合は、その都度質問を重ねて明確化する。
- 会話が途絶えた後に再度議論を開始する場合、必ず本仕様書（ダンジョンゲーム仕様書）を参照・読み込み、これを元に仕様検討・決定を行うこと。

---

## 目次
1. ゲーム概要
2. ダンジョン構造
3. バトルシステム
4. 全滅・復活・ペナルティ
5. ギルド・救急車機能
6. 武器・装備・鑑定・トレードシステム
7. 商店・マーケット・価格変動
8. UI/UX要素
9. パーティ募集・マッチング仕様　★
10. システム詳細（追加決定仕様）★
11. 仕様変更履歴

---

## 1. ゲーム概要

- プレイヤーは無限階層のダンジョンを攻略する。
- 各階層にはボスや特別なイベントが発生する。
- バトルは完全リアルタイム方式で進行。
- すべてのプレイヤーはゲーム開始時から地上の単一のギルドに自動所属する（ギルド未所属状態は存在しない）。
- ギルドによる協力要素や救急車（復活支援）システムを導入。
- 武器・装備の鑑定やアイテムトレード、商店取引等の要素を実装。
- ソロプレイ・マルチプレイ（協力パーティ）両対応。
- 分散型サーバー設計により、パーティ最大人数や同時戦闘規模はサーバースペックやイベント内容に応じて可変（例：通常2～8人、レイド等で16人以上も検討可）。

---

## 2. ダンジョン構造

- 各ダンジョンは無限階層で構成される。
- 階層ごとに「通常階層」「ボス階層」「イベント階層」「サプライズ階層」など、特徴の異なるフロアが出現する。
    - 通常階層：一般的な敵やトラップが出現。
    - ボス階層：定期的（例：10階ごと等）に強力なボスが出現、撃破後のみ次の階層へ進行可能。
    - イベント階層：ランダムに特殊イベントや報酬、ギミック等が発生。
    - サプライズ階層：裏ボス・連戦・特別報酬などの突発的なサプライズが発生。
- 各階層に特別なイベントが発生する場合がある。
- ダンジョン内の移動や探索はリアルタイム進行。
- 各階層は「物語や世界観に応じたテーマ」を持つ。  
- 階層が初めて解放された時点で、その階層の地形・敵配置などをランダム生成し、その後は全プレイヤー間で同じマップ（固定）を共有する。  
- 攻略情報の共有やコミュニティでの協力が可能。

### サプライズ階層・隠し要素仕様（追加）

- サプライズ階層（裏ボス・特殊イベントなど）は、完全ランダム出現に加え、特定条件（例：特定アイテム所持、特定アクション達成など）で突入できる場合もある。
- サプライズ階層の特定条件は全て非公開・隠し要素扱いとし、公式からのヒントや情報公開は行わない。
- サプライズ階層では、その階層でしか入手できない隠し限定アイテムや特別報酬が存在する。
- サプライズ階層限定アイテム・報酬も、他のプレイヤーとトレードや商店での売買が可能。
- サプライズ階層で獲得した限定アイテムも通常アイテムと同様に未鑑定状態で入手し、地上の商店や鑑定スクロールで鑑定が必要。
- サプライズ階層のボスや特殊イベントは、一度クリアしても一定期間後や特殊条件で再出現可能とする。

---

## 3. バトルシステム

- バトルはターン制ではなく、完全リアルタイム方式で進行する。
- プレイヤーおよび敵キャラクターは、各自の速度・クールタイムに応じて順次行動する。
- スキルやアイテムの使用もリアルタイムで管理される。
- 通常攻撃、スキル（特殊技）、必殺技、アイテム使用など多様なアクションが可能。
    - スキル発動にはクールタイムやコスト（MP、スタミナ等）を設ける。
- 状態異常やバフ・デバフも時間経過で管理される。
- ソロ＆マルチ両対応。マルチ時のパーティ人数は可変（通常2～4人、イベント等で最大8人以上も対応）。
- 大規模戦闘（レイド・ギルドイベント等）はサーバー状況により16人～数十人規模も可能。
- パーティ協力仕様：
    - プレイヤーのビルドは完全自由。職業や役割（タンク/アタッカー等）の強制はなく、スキル・装備・能力の組み合わせにより戦術を構築。
    - パーティ内に明確な役割分担は設けず、構成自由・ビルド自由。
    - リアルタイム連携技・協力必殺技など、複数人が特定条件を満たすと発動できる協力アクションあり（例：同時攻撃やスキル組み合わせ）。
    - 蘇生：戦闘中、パーティメンバーのスキルやアイテムで蘇生可能（制限あり）。
    - 全滅時はセーブポイント等に戻るか、救援（後述）で現地復活を選択。
- 報酬は参加者全員が同じ内容を獲得（均等分配方式）。
    - レアアイテムも原則全員獲得とする（例外時は仕様書で明記）。
- バトル操作は「完全オート」ではなく、一部手動操作（スキルや緊急回避など）が可能。

---

## 4. 全滅・復活・ペナルティ

- パーティが全滅した場合、以下の2パターンが存在する。

### 1. セーブポイント（拠点）に戻る場合
- 装備中の武器・防具・アイテムが全滅現場に「落ちる」（ドロップされる）。
- 落ちたアイテムは、後で現地に回収しに行くことができる。
- 他のプレイヤーには「落ちたアイテムをギルドに届ける」クエストが発生する場合がある。
- インベントリ（未装備）のアイテムは失われない。

### 2. その場で復活（救援）する場合
- 全滅したパーティは、救援クエスト（ギルド救急車）を発行できる。
- 規定時間内に救援が成功した場合、装備品ドロップや追加ペナルティ無しでその場復活できる。
- 規定時間内に救援が来なかった場合、装備中の武器・防具・アイテムが現地にドロップされる。

---

## 5. ギルド・救急車機能

- すべてのプレイヤーはゲーム開始時から地上の単一のギルドに所属する（ギルド未所属状態は存在しない）。
- パーティ全滅時、「救援クエスト（ギルド救急車）」がギルド全体（＝全プレイヤー）に自動発行される。
- 救援クエストは「早い者勝ち」方式で、最初に現地到達した救援者のみが報酬を獲得できる。
- 救援報酬は「ゴールド」「ギルドポイント」「キャラクター・武器の成長アイテム」から構成される。
- 救援失敗時は、全滅パーティの装備中アイテムが現地にドロップされる。
- 落ちたアイテムを現地で回収し、拠点に持ち帰るクエストもギルド救援の一部として発生する。

---

## 6. 武器・装備・鑑定・トレードシステム

- 武器・防具・アイテムはダンジョン内で入手し、未鑑定状態では「名前や詳細性能・特殊効果」は非公開。
- 未鑑定アイテムは、地上にある商店でゴールドを支払って鑑定してもらえる。
- 商店では「鑑定スクロール」も販売している。鑑定スクロールを持っていれば、ダンジョン内などどこでも未鑑定アイテムを即座に鑑定できる（消費アイテム）。
- 鑑定スクロールは消費アイテムで、1枚につき1つの未鑑定アイテムを鑑定可能。
- 鑑定スクロールの販売価格は、商店で直接鑑定を依頼する場合よりも高く設定されている。
- サプライズ階層限定アイテムを含め、全ての未鑑定アイテムがこの仕組みで鑑定可能。
- 鑑定済みの武器・防具・アイテムのみが地上の商店で売却・トレード可能。
- プレイヤー間トレードもゲーム内通貨（ゴールド）でのみ実施できる。
- NFT化やブロックチェーン連携は行わない。全てゲーム内のみで完結。
- 鑑定済みアイテムは、ゲーム内マーケットや商店にゴールドで出品・購入ができる。

---

## 7. 商店・マーケット・価格変動

- 商店で売却された鑑定済みアイテムは「販売リスト」として記録され、他プレイヤーが購入できる。
- 売却品リストは在庫制（売却された分だけ存在）とし、売り切れ後はリストから消える。
- 商店での売買はゲーム内通貨（ゴールド）のみ利用可能。
- 販売価格は、アイテムのゲーム内人気度やレアリティに応じて自動的に変動する（ダイナミックプライシング）。
    - 人気度は直近の取引件数や装備率などから自動算出。
    - レアリティは武器・防具・アイテム固有の希少性に基づく。

---

## 8. UI/UX要素

- ゲーム画面はリアルタイム進行を意識したタイムライン型のUI。
- バトル、パーティ状況、マップ、ギルド救急車要請などの情報を一画面に集約。
- モバイル・PC両対応を想定（レスポンシブデザイン推奨）。

---

## 9. パーティ募集・マッチング仕様　★

- マルチプレイ時のパーティ募集は「自動マッチング」に加え、「手動招待」や「ID指定」などの方式も許容する。

---

## 10. システム詳細（追加決定仕様）★

### アイテム強化・合成システム
- 装備やキャラの強化、合成、進化が可能。
- 強化アイテムは商店・ドロップ両方から入手できる。

### 装備の耐久度・修理
- 装備品に耐久度は導入しない（壊れない・消耗しない）。

### スキル習得・成長システム
- 下記全方式を導入：
    - レベルアップで「基本スキル」を自動習得
    - スキル書やアイテムで習得・強化
    - NPC/師匠からの伝授で習得
    - スキル熟練度（使用回数・経験値）による成長要素も有り

### 職業（クラス）・転職システム
- 種族システム  
    - プレイヤーキャラは「人間」「エルフ」「メカ」「モンスター」から選択
    - 各種族で得意な職業やスキル傾向が異なる
        - 人間：スキル高度化（応用・多才型）
        - エルフ：魔法系
        - メカ：物理攻撃・サポート系
        - モンスター：特殊・ユニーク系
- 性格  
    - 「善／中立／悪」のいずれかを持つ
    - 性格によって習得可能スキル・職業や成長傾向、合成進化先が変化
- 職業制限  
    - 種族・性格の組み合わせで就ける職業や成長傾向が限定される
- 転職・合成
    - レベルアップで転職が可能
    - キャラ合成によって上級職・特殊職へ進化可能
    - 合成素材キャラの「種族の割合」「性格」の組み合わせによって進化先が変化
- 職業バリエーション
    - 組み合わせごとに多数の職業/上級職/特殊職を用意
    - 例：パラディン、ダークナイト、ハイエルフ、ダークエルフ、ガーディアン、アサルトドローン、セイント、バイオサイボーグ、ナイトメアロード等

### アイテムシステム
- 全てのカテゴリを導入
    - 装備品（武器、防具、アクセサリー等）
    - 消費アイテム（回復・強化・蘇生・バフ等）
    - 素材アイテム（装備・キャラ合成や進化、クラフト等に利用）
    - 特殊アイテム（イベントキー、レアアイテム、謎のアイテム等）
- 装備スロット数やアイテムの等級も拡張可能

### ダンジョン・フィールド探索システム
- ランダム生成ダンジョン、固定マップ、イベント専用ダンジョン、ボス専用エリア等、複数方式を導入予定
- 仕掛け・ギミック・隠し要素・トラップ等も今後検討

---

## 11. 仕様変更履歴

### 2025-07-19
- システム詳細（アイテム強化・合成、装備耐久度廃止、スキル成長多方式、職業種族性格多様化、アイテム全種・合成職業バリエーション等）を追記

### 2025-07-10
- 武器鑑定システムをNFT対応に拡張（→2025-07-19付でNFT非対応へ変更）
- 全滅時のペナルティを強化

### 2025-07-17
- バトル方式をリアルタイムに決定
- ギルド救急車機能を追加
- ダンジョン20階層構造を決定

### 2025-07-19
- 無限階層仕様、全員ギルド自動所属、全滅時のペナルティ＆救援クエスト、武器未鑑定時オーラ等の新仕様を反映
- NFT仕様を撤廃し、ゲーム内ゴールドによるトレード・ダイナミックプライシング商店を追加
- バトル/協力・マルチプレイ/パーティ人数可変/自由ビルド/蘇生・連携・報酬分配等の最新仕様を反映
- 階層ごとに初回解放時にランダム生成し、その後は全プレイヤーで固定共有となるダンジョン構造を追加
- パーティ募集に手動招待・ID指定を許容する仕様を追加
- バトル操作に一部手動操作を許容する仕様を追加
- サプライズ階層・鑑定スクロール・隠し限定アイテム等の新仕様を追加

---

## 補足

- ここに記載の内容は議論・実装に応じて随時アップデートしてください。
- 詳細なAPI仕様やクラス設計などは別ドキュメントで管理することを推奨します。
