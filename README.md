# ダンジョンゲーム仕様書

## 仕様の決定方法

- 本仕様書の内容は、今後の議論や実装において基準となる「確定仕様」として扱う。
- 仕様を詳細化・確定する際は、質問形式で項目ごとの確認を行い、オーナー（kayabuking）がy（はい）／n（いいえ）で回答することで仕様を決定する。
- y/n回答は決定事項として記録し、仕様書に反映する。
- 追加質問や補足が必要な場合は、その都度質問を重ねて明確化する。
- 会話が途絶えた後に再度議論を開始する場合、必ず本仕様書（ダンジョンゲーム仕様書）を参照・読み込み、これを元に仕様検討・決定を行うこと。

---

## 目次
1. ゲーム概要
2. ダンジョン構造
3. バトルシステム
4. 全滅・復活・ペナルティ
5. ギルド・救急車機能
6. 武器・装備・鑑定・トレードシステム
7. 商店・マーケット・価格変動
8. UI/UX要素
9. 仕様変更履歴

---

## 1. ゲーム概要

- プレイヤーは無限階層のダンジョンを攻略する。
- 各階層にはボスや特別なイベントが発生する。
- バトルは完全リアルタイム方式で進行。
- すべてのプレイヤーはゲーム開始時から地上の単一のギルドに自動所属する（ギルド未所属状態は存在しない）。
- ギルドによる協力要素や救急車（復活支援）システムを導入。
- 武器・装備の鑑定やアイテムトレード、商店取引等の要素を実装。
- ソロプレイ・マルチプレイ（協力パーティ）両対応。
- 分散型サーバー設計により、パーティ最大人数や同時戦闘規模はサーバースペックやイベント内容に応じて可変（例：通常2～8人、レイド等で16人～大規模対応）。

---

## 2. ダンジョン構造

- 各ダンジョンは無限階層で構成される。
- 階層ごとに「通常階層」「ボス階層」「イベント階層」「サプライズ階層」など、特徴の異なるフロアが出現する。
    - 通常階層：一般的な敵やトラップが出現。
    - ボス階層：定期的（例：10階ごと等）に強力なボスが出現、撃破後のみ次の階層へ進行可能。
    - イベント階層：ランダムに特殊イベントや報酬、ギミック等が発生。
    - サプライズ階層：裏ボス・連戦・特別報酬などの突発的なサプライズが発生。
- 各階層に特別なイベントが発生する場合がある。
- ダンジョン内の移動や探索はリアルタイム進行。

---

## 3. バトルシステム

- バトルはターン制ではなく、完全リアルタイム方式で進行する。
- プレイヤーおよび敵キャラクターは、各自の速度・クールタイムに応じて順次行動する。
- スキルやアイテムの使用もリアルタイムで管理される。
- 通常攻撃、スキル（特殊技）、必殺技、アイテム使用など多様なアクションが可能。
    - スキル発動にはクールタイムやコスト（MP、スタミナ等）を設ける。
- 状態異常やバフ・デバフも時間経過で管理される。
- ソロ＆マルチ両対応。マルチ時のパーティ人数は可変（通常2～4人、イベント等で最大8人以上も対応）。
- 大規模戦闘（レイド・ギルドイベント等）はサーバー状況により16人～数十人規模も可能。
- パーティ協力仕様：
    - プレイヤーのビルドは完全自由。職業や役割（タンク/アタッカー等）の強制はなく、スキル・装備・能力の組み合わせにより戦術を構築。
    - パーティ内に明確な役割分担は設けず、構成自由・ビルド自由。
    - リアルタイム連携技・協力必殺技など、複数人が特定条件を満たすと発動できる協力アクションあり（例：同時攻撃やスキル組み合わせ）。
    - 蘇生：戦闘中、パーティメンバーのスキルやアイテムで蘇生可能（制限あり）。
    - 全滅時はセーブポイント等に戻るか、救援（後述）で現地復活を選択。
- 報酬は参加者全員が同じ内容を獲得（均等分配方式）。
    - レアアイテムも原則全員獲得とする（例外時は仕様書で明記）。

---

## 4. 全滅・復活・ペナルティ

- パーティが全滅した場合、以下の2パターンが存在する。

### 1. セーブポイント（拠点）に戻る場合
- 装備中の武器・防具・アイテムが全滅現場に「落ちる」（ドロップされる）。
- 落ちたアイテムは、後で現地に回収しに行くことができる。
- 他のプレイヤーには「落ちたアイテムをギルドに届ける」クエストが発生する場合がある。
- インベントリ（未装備）のアイテムは失われない。

### 2. その場で復活（救援）する場合
- 全滅したパーティは、救援クエスト（ギルド救急車）を発行できる。
- 規定時間内に救援が成功した場合、装備品ドロップや追加ペナルティ無しでその場復活できる。
- 規定時間内に救援が来なかった場合、装備中の武器・防具・アイテムが現地にドロップされる。

---

## 5. ギルド・救急車機能

- すべてのプレイヤーはゲーム開始時から地上の単一のギルドに所属する（ギルド未所属状態は存在しない）。
- パーティ全滅時、「救援クエスト（ギルド救急車）」がギルド全体（＝全プレイヤー）に自動発行される。
- 救援クエストは「早い者勝ち」方式で、最初に現地到達した救援者のみが報酬を獲得できる。
- 救援報酬は「ゴールド」「ギルドポイント」「キャラクター・武器の成長アイテム」から構成される。
- 救援失敗時は、全滅パーティの装備中アイテムが現地にドロップされる。
- 落ちたアイテムを現地で回収し、拠点に持ち帰るクエストもギルド救援の一部として発生する。

---

## 6. 武器・装備・鑑定・トレードシステム

- 武器・防具・アイテムはダンジョン内で入手し、未鑑定状態では「名前や詳細性能・特殊効果」は非公開。
- 鑑定には拠点や特定NPCを利用し、鑑定にはゴールドや素材が必要な場合がある。
- 鑑定済みの武器・防具・アイテムのみが地上の商店で売却・トレード可能。
- プレイヤー間トレードもゲーム内通貨（ゴールド）でのみ実施できる。
- NFT化やブロックチェーン連携は行わない。全てゲーム内のみで完結。
- 鑑定済みアイテムは、ゲーム内マーケットや商店にゴールドで出品・購入ができる。

---

## 7. 商店・マーケット・価格変動

- 商店で売却された鑑定済みアイテムは「販売リスト」として記録され、他プレイヤーが購入できる。
- 売却品リストは在庫制（売却された分だけ存在）とし、売り切れ後はリストから消える。
- 商店での売買はゲーム内通貨（ゴールド）のみ利用可能。
- 販売価格は、アイテムのゲーム内人気度やレアリティに応じて自動的に変動する（ダイナミックプライシング）。
    - 人気度は直近の取引件数や装備率などから自動算出。
    - レアリティは武器・防具・アイテム固有の希少性に基づく。

---

## 8. UI/UX要素

- ゲーム画面はリアルタイム進行を意識したタイムライン型のUI。
- バトル、パーティ状況、マップ、ギルド救急車要請などの情報を一画面に集約。
- モバイル・PC両対応を想定（レスポンシブデザイン推奨）。

---

## 9. 仕様変更履歴

### 2025-07-10
- 武器鑑定システムをNFT対応に拡張（→2025-07-19付でNFT非対応へ変更）
- 全滅時のペナルティを強化

### 2025-07-17
- バトル方式をリアルタイムに決定
- ギルド救急車機能を追加
- ダンジョン20階層構造を決定

### 2025-07-19
- 無限階層仕様、全員ギルド自動所属、全滅時のペナルティ＆救援クエスト、武器未鑑定時オーラ等の新仕様を反映
- NFT仕様を撤廃し、ゲーム内ゴールドによるトレード・ダイナミックプライシング商店を追加
- バトル/協力・マルチプレイ/パーティ人数可変/自由ビルド/蘇生・連携・報酬分配等の最新仕様を反映

---

## 補足

- ここに記載の内容は議論・実装に応じて随時アップデートしてください。
- 詳細なAPI仕様やクラス設計などは別ドキュメントで管理することを推奨します。
